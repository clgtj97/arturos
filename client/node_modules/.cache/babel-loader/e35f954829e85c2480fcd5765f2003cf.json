{"ast":null,"code":"'use strict';\n\nfunction attachPush(req) {\n  var handle = req.socket._handle;\n  handle.getStream(function (stream) {\n    stream.on('pushPromise', function (push) {\n      req.emit('push', push);\n    });\n  });\n}\n\nexports.onNewListener = function onNewListener(type) {\n  var req = this;\n\n  if (type !== 'push') {\n    return;\n  } // Not first listener\n\n\n  if (req.listeners('push').length !== 0) {\n    return;\n  }\n\n  if (!req.socket) {\n    req.on('socket', function () {\n      attachPush(req);\n    });\n    return;\n  }\n\n  attachPush(req);\n};","map":null,"metadata":{},"sourceType":"script"}